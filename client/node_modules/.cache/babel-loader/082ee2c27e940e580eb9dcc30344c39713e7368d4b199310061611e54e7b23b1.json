{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Mahantesh\\\\Desktop\\\\SSLAB\\\\stock-dashboard\\\\client\\\\src\\\\components\\\\Dashboard.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState, useRef } from 'react';\nimport { io } from 'socket.io-client';\nimport StockRow from './StockRow';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst SERVER = process.env.REACT_APP_SERVER || 'http://localhost:4000';\nexport default function Dashboard({\n  email,\n  onLogout\n}) {\n  _s();\n  const [supported, setSupported] = useState([]);\n  const [prices, setPrices] = useState({});\n  const [subscriptions, setSubscriptions] = useState(new Set());\n  const socketRef = useRef(null);\n  useEffect(() => {\n    // fetch supported ticker list\n    fetch(`${SERVER}/tickers`).then(r => r.json()).then(data => {\n      setSupported(data.supported);\n      setPrices(data.prices || {});\n    });\n\n    // connect socket\n    const socket = io(SERVER, {\n      transports: ['websocket']\n    });\n    socketRef.current = socket;\n    socket.on('connect', () => {\n      console.log('connected', socket.id);\n    });\n    socket.on('price_update', ({\n      ticker,\n      price,\n      ts\n    }) => {\n      setPrices(prev => ({\n        ...prev,\n        [ticker]: price\n      }));\n    });\n    return () => {\n      socket.disconnect();\n    };\n  }, []);\n  const subscribe = ticker => {\n    if (!socketRef.current) return;\n    socketRef.current.emit('subscribe', ticker);\n    setSubscriptions(prev => new Set(prev).add(ticker));\n  };\n  const unsubscribe = ticker => {\n    if (!socketRef.current) return;\n    socketRef.current.emit('unsubscribe', ticker);\n    setSubscriptions(prev => {\n      const s = new Set(prev);\n      s.delete(ticker);\n      return s;\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"dashboard\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"top\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: [\"Logged in as: \", /*#__PURE__*/_jsxDEV(\"b\", {\n          children: email\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 58,\n          columnNumber: 28\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 58,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: onLogout,\n        children: \"Logout\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 59,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n      children: \"Supported Stocks\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"stock-list\",\n      children: supported.map(t => /*#__PURE__*/_jsxDEV(StockRow, {\n        ticker: t,\n        price: prices[t],\n        subscribed: subscriptions.has(t),\n        onSubscribe: () => subscribe(t),\n        onUnsubscribe: () => unsubscribe(t)\n      }, t, false, {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n      children: \"Your Subscriptions\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n      children: Array.from(subscriptions).length === 0 ? /*#__PURE__*/_jsxDEV(\"li\", {\n        children: \"(none)\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 51\n      }, this) : Array.from(subscriptions).map(t => /*#__PURE__*/_jsxDEV(\"li\", {\n        children: [t, \" \\u2014 \", prices[t]]\n      }, t, true, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 46\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginTop: 16\n      },\n      children: /*#__PURE__*/_jsxDEV(\"small\", {\n        children: \"Open another browser tab/window and log in with a different email to simulate another user.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 56,\n    columnNumber: 5\n  }, this);\n}\n_s(Dashboard, \"WpbtiKUa5Or9hpbWFe1UhJy4eaI=\");\n_c = Dashboard;\nvar _c;\n$RefreshReg$(_c, \"Dashboard\");","map":{"version":3,"names":["React","useEffect","useState","useRef","io","StockRow","jsxDEV","_jsxDEV","SERVER","process","env","REACT_APP_SERVER","Dashboard","email","onLogout","_s","supported","setSupported","prices","setPrices","subscriptions","setSubscriptions","Set","socketRef","fetch","then","r","json","data","socket","transports","current","on","console","log","id","ticker","price","ts","prev","disconnect","subscribe","emit","add","unsubscribe","s","delete","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","map","t","subscribed","has","onSubscribe","onUnsubscribe","Array","from","length","style","marginTop","_c","$RefreshReg$"],"sources":["C:/Users/Mahantesh/Desktop/SSLAB/stock-dashboard/client/src/components/Dashboard.js"],"sourcesContent":["import React, { useEffect, useState, useRef } from 'react';\r\nimport { io } from 'socket.io-client';\r\nimport StockRow from './StockRow';\r\n\r\nconst SERVER = process.env.REACT_APP_SERVER || 'http://localhost:4000';\r\n\r\nexport default function Dashboard({ email, onLogout }) {\r\n  const [supported, setSupported] = useState([]);\r\n  const [prices, setPrices] = useState({});\r\n  const [subscriptions, setSubscriptions] = useState(new Set());\r\n  const socketRef = useRef(null);\r\n\r\n  useEffect(() => {\r\n    // fetch supported ticker list\r\n    fetch(`${SERVER}/tickers`)\r\n      .then(r => r.json())\r\n      .then(data => {\r\n        setSupported(data.supported);\r\n        setPrices(data.prices || {});\r\n      });\r\n\r\n    // connect socket\r\n    const socket = io(SERVER, { transports: ['websocket'] });\r\n    socketRef.current = socket;\r\n\r\n    socket.on('connect', () => {\r\n      console.log('connected', socket.id);\r\n    });\r\n\r\n    socket.on('price_update', ({ ticker, price, ts }) => {\r\n      setPrices(prev => ({ ...prev, [ticker]: price }));\r\n    });\r\n\r\n    return () => {\r\n      socket.disconnect();\r\n    };\r\n  }, []);\r\n\r\n  const subscribe = (ticker) => {\r\n    if (!socketRef.current) return;\r\n    socketRef.current.emit('subscribe', ticker);\r\n    setSubscriptions(prev => new Set(prev).add(ticker));\r\n  };\r\n\r\n  const unsubscribe = (ticker) => {\r\n    if (!socketRef.current) return;\r\n    socketRef.current.emit('unsubscribe', ticker);\r\n    setSubscriptions(prev => {\r\n      const s = new Set(prev);\r\n      s.delete(ticker);\r\n      return s;\r\n    });\r\n  };\r\n\r\n  return (\r\n    <div className=\"dashboard\">\r\n      <div className=\"top\">\r\n        <div>Logged in as: <b>{email}</b></div>\r\n        <button onClick={onLogout}>Logout</button>\r\n      </div>\r\n\r\n      <h3>Supported Stocks</h3>\r\n      <div className=\"stock-list\">\r\n        {supported.map(t => (\r\n          <StockRow\r\n            key={t}\r\n            ticker={t}\r\n            price={prices[t]}\r\n            subscribed={subscriptions.has(t)}\r\n            onSubscribe={() => subscribe(t)}\r\n            onUnsubscribe={() => unsubscribe(t)}\r\n          />\r\n        ))}\r\n      </div>\r\n\r\n      <h3>Your Subscriptions</h3>\r\n      <ul>\r\n        {Array.from(subscriptions).length === 0 ? <li>(none)</li> :\r\n          Array.from(subscriptions).map(t => <li key={t}>{t} â€” {prices[t]}</li>)}\r\n      </ul>\r\n\r\n      <div style={{ marginTop: 16 }}>\r\n        <small>Open another browser tab/window and log in with a different email to simulate another user.</small>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}