{"ast":null,"code":"import _objectSpread from\"C:/Users/Mahantesh/Desktop/SSLAB/stock-dashboard/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useState,useRef}from'react';import{io}from'socket.io-client';import StockRow from'./StockRow';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const SERVER='https://escrow-dashboard-backend.onrender.com';export default function Dashboard(_ref){let{email,onLogout}=_ref;const[supported,setSupported]=useState([]);const[prices,setPrices]=useState({});const[subscriptions,setSubscriptions]=useState(new Set());const[loading,setLoading]=useState(true);const[connectionStatus,setConnectionStatus]=useState('Connecting...');const socketRef=useRef(null);useEffect(()=>{// Initial fetch of supported tickers and base prices\nfetch(\"\".concat(SERVER,\"/tickers\")).then(r=>r.json()).then(data=>{setSupported(data.supported||[]);setPrices(data.prices||{});setLoading(false);}).catch(()=>{setConnectionStatus('Failed to fetch initial data from server.');setLoading(false);});const socket=io(SERVER,{transports:['websocket']});socketRef.current=socket;socket.on('connect',()=>{setConnectionStatus('Connected to price server.');});socket.on('disconnect',()=>{setConnectionStatus('Disconnected from price server.');});socket.on('price_update',_ref2=>{let{ticker,price}=_ref2;setPrices(prev=>_objectSpread(_objectSpread({},prev),{},{[ticker]:price}));});return()=>{socket.disconnect();};},[]);const subscribe=ticker=>{if(!socketRef.current)return;socketRef.current.emit('subscribe',ticker);setSubscriptions(prev=>{const next=new Set(prev);next.add(ticker);return next;});};const unsubscribe=ticker=>{if(!socketRef.current)return;socketRef.current.emit('unsubscribe',ticker);setSubscriptions(prev=>{const next=new Set(prev);next.delete(ticker);return next;});};return/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard-header\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"label-text\",children:\"Logged in as\"}),/*#__PURE__*/_jsx(\"div\",{className:\"user-email\",children:email})]}),/*#__PURE__*/_jsx(\"button\",{className:\"secondary-button\",onClick:onLogout,children:\"Logout\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"status-bar\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"status-dot\"}),\" \",connectionStatus]}),/*#__PURE__*/_jsxs(\"section\",{className:\"section-card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"section-card-header\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"section-title\",children:\"Supported Stocks\"}),/*#__PURE__*/_jsx(\"p\",{className:\"section-description\",children:\"Select the stock tickers you want to monitor. Prices are simulated and updated every second.\"})]}),loading?/*#__PURE__*/_jsx(\"div\",{className:\"info-text\",children:\"Loading stock information\\u2026\"}):/*#__PURE__*/_jsx(\"div\",{className:\"stock-list\",children:supported.map(ticker=>/*#__PURE__*/_jsx(StockRow,{ticker:ticker,price:prices[ticker],subscribed:subscriptions.has(ticker),onSubscribe:()=>subscribe(ticker),onUnsubscribe:()=>unsubscribe(ticker)},ticker))})]}),/*#__PURE__*/_jsxs(\"section\",{className:\"section-card\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"section-title\",children:\"Your Subscriptions\"}),subscriptions.size===0?/*#__PURE__*/_jsx(\"p\",{className:\"info-text\",children:\"(none) \\u2014 You have not subscribed to any stocks yet. Use the Subscribe button above to start monitoring.\"}):/*#__PURE__*/_jsx(\"ul\",{className:\"subscription-list\",children:Array.from(subscriptions).map(t=>/*#__PURE__*/_jsxs(\"li\",{className:\"subscription-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"subscription-ticker\",children:t}),/*#__PURE__*/_jsx(\"span\",{className:\"subscription-price\",children:prices[t]!==undefined?prices[t]:'—'})]},t))}),/*#__PURE__*/_jsx(\"p\",{className:\"helper-text\",children:\"Open another browser tab/window and log in with a different email to simulate another client. Subscriptions and updates are independent for each user.\"})]})]});}","map":{"version":3,"names":["React","useEffect","useState","useRef","io","StockRow","jsx","_jsx","jsxs","_jsxs","SERVER","Dashboard","_ref","email","onLogout","supported","setSupported","prices","setPrices","subscriptions","setSubscriptions","Set","loading","setLoading","connectionStatus","setConnectionStatus","socketRef","fetch","concat","then","r","json","data","catch","socket","transports","current","on","_ref2","ticker","price","prev","_objectSpread","disconnect","subscribe","emit","next","add","unsubscribe","delete","className","children","onClick","map","subscribed","has","onSubscribe","onUnsubscribe","size","Array","from","t","undefined"],"sources":["C:/Users/Mahantesh/Desktop/SSLAB/stock-dashboard/client/src/components/Dashboard.js"],"sourcesContent":["import React, { useEffect, useState, useRef } from 'react';\r\nimport { io } from 'socket.io-client';\r\nimport StockRow from './StockRow';\r\n\r\nconst SERVER = 'https://escrow-dashboard-backend.onrender.com';\r\n\r\nexport default function Dashboard({ email, onLogout }) {\r\n  const [supported, setSupported] = useState([]);\r\n  const [prices, setPrices] = useState({});\r\n  const [subscriptions, setSubscriptions] = useState(new Set());\r\n  const [loading, setLoading] = useState(true);\r\n  const [connectionStatus, setConnectionStatus] = useState('Connecting...');\r\n  const socketRef = useRef(null);\r\n\r\n  useEffect(() => {\r\n    // Initial fetch of supported tickers and base prices\r\n    fetch(`${SERVER}/tickers`)\r\n      .then((r) => r.json())\r\n      .then((data) => {\r\n        setSupported(data.supported || []);\r\n        setPrices(data.prices || {});\r\n        setLoading(false);\r\n      })\r\n      .catch(() => {\r\n        setConnectionStatus('Failed to fetch initial data from server.');\r\n        setLoading(false);\r\n      });\r\n\r\n    const socket = io(SERVER, { transports: ['websocket'] });\r\n    socketRef.current = socket;\r\n\r\n    socket.on('connect', () => {\r\n      setConnectionStatus('Connected to price server.');\r\n    });\r\n\r\n    socket.on('disconnect', () => {\r\n      setConnectionStatus('Disconnected from price server.');\r\n    });\r\n\r\n    socket.on('price_update', ({ ticker, price }) => {\r\n      setPrices((prev) => ({ ...prev, [ticker]: price }));\r\n    });\r\n\r\n    return () => {\r\n      socket.disconnect();\r\n    };\r\n  }, []);\r\n\r\n  const subscribe = (ticker) => {\r\n    if (!socketRef.current) return;\r\n    socketRef.current.emit('subscribe', ticker);\r\n    setSubscriptions((prev) => {\r\n      const next = new Set(prev);\r\n      next.add(ticker);\r\n      return next;\r\n    });\r\n  };\r\n\r\n  const unsubscribe = (ticker) => {\r\n    if (!socketRef.current) return;\r\n    socketRef.current.emit('unsubscribe', ticker);\r\n    setSubscriptions((prev) => {\r\n      const next = new Set(prev);\r\n      next.delete(ticker);\r\n      return next;\r\n    });\r\n  };\r\n\r\n  return (\r\n    <div className=\"dashboard-container\">\r\n      <div className=\"dashboard-header\">\r\n        <div>\r\n          <div className=\"label-text\">Logged in as</div>\r\n          <div className=\"user-email\">{email}</div>\r\n        </div>\r\n        <button className=\"secondary-button\" onClick={onLogout}>\r\n          Logout\r\n        </button>\r\n      </div>\r\n\r\n      <div className=\"status-bar\">\r\n        <span className=\"status-dot\" /> {connectionStatus}\r\n      </div>\r\n\r\n      <section className=\"section-card\">\r\n        <div className=\"section-card-header\">\r\n          <h2 className=\"section-title\">Supported Stocks</h2>\r\n          <p className=\"section-description\">\r\n            Select the stock tickers you want to monitor. Prices are simulated and updated every second.\r\n          </p>\r\n        </div>\r\n\r\n        {loading ? (\r\n          <div className=\"info-text\">Loading stock information…</div>\r\n        ) : (\r\n          <div className=\"stock-list\">\r\n            {supported.map((ticker) => (\r\n              <StockRow\r\n                key={ticker}\r\n                ticker={ticker}\r\n                price={prices[ticker]}\r\n                subscribed={subscriptions.has(ticker)}\r\n                onSubscribe={() => subscribe(ticker)}\r\n                onUnsubscribe={() => unsubscribe(ticker)}\r\n              />\r\n            ))}\r\n          </div>\r\n        )}\r\n      </section>\r\n\r\n      <section className=\"section-card\">\r\n        <h2 className=\"section-title\">Your Subscriptions</h2>\r\n        {subscriptions.size === 0 ? (\r\n          <p className=\"info-text\">\r\n            (none) — You have not subscribed to any stocks yet. Use the Subscribe button above to start monitoring.\r\n          </p>\r\n        ) : (\r\n          <ul className=\"subscription-list\">\r\n            {Array.from(subscriptions).map((t) => (\r\n              <li key={t} className=\"subscription-item\">\r\n                <span className=\"subscription-ticker\">{t}</span>\r\n                <span className=\"subscription-price\">\r\n                  {prices[t] !== undefined ? prices[t] : '—'}\r\n                </span>\r\n              </li>\r\n            ))}\r\n          </ul>\r\n        )}\r\n\r\n        <p className=\"helper-text\">\r\n          Open another browser tab/window and log in with a different email to simulate another client. \r\n          Subscriptions and updates are independent for each user.\r\n        </p>\r\n      </section>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"4IAAA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,QAAQ,CAAEC,MAAM,KAAQ,OAAO,CAC1D,OAASC,EAAE,KAAQ,kBAAkB,CACrC,MAAO,CAAAC,QAAQ,KAAM,YAAY,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAElC,KAAM,CAAAC,MAAM,CAAG,+CAA+C,CAE9D,cAAe,SAAS,CAAAC,SAASA,CAAAC,IAAA,CAAsB,IAArB,CAAEC,KAAK,CAAEC,QAAS,CAAC,CAAAF,IAAA,CACnD,KAAM,CAACG,SAAS,CAAEC,YAAY,CAAC,CAAGd,QAAQ,CAAC,EAAE,CAAC,CAC9C,KAAM,CAACe,MAAM,CAAEC,SAAS,CAAC,CAAGhB,QAAQ,CAAC,CAAC,CAAC,CAAC,CACxC,KAAM,CAACiB,aAAa,CAAEC,gBAAgB,CAAC,CAAGlB,QAAQ,CAAC,GAAI,CAAAmB,GAAG,CAAC,CAAC,CAAC,CAC7D,KAAM,CAACC,OAAO,CAAEC,UAAU,CAAC,CAAGrB,QAAQ,CAAC,IAAI,CAAC,CAC5C,KAAM,CAACsB,gBAAgB,CAAEC,mBAAmB,CAAC,CAAGvB,QAAQ,CAAC,eAAe,CAAC,CACzE,KAAM,CAAAwB,SAAS,CAAGvB,MAAM,CAAC,IAAI,CAAC,CAE9BF,SAAS,CAAC,IAAM,CACd;AACA0B,KAAK,IAAAC,MAAA,CAAIlB,MAAM,YAAU,CAAC,CACvBmB,IAAI,CAAEC,CAAC,EAAKA,CAAC,CAACC,IAAI,CAAC,CAAC,CAAC,CACrBF,IAAI,CAAEG,IAAI,EAAK,CACdhB,YAAY,CAACgB,IAAI,CAACjB,SAAS,EAAI,EAAE,CAAC,CAClCG,SAAS,CAACc,IAAI,CAACf,MAAM,EAAI,CAAC,CAAC,CAAC,CAC5BM,UAAU,CAAC,KAAK,CAAC,CACnB,CAAC,CAAC,CACDU,KAAK,CAAC,IAAM,CACXR,mBAAmB,CAAC,2CAA2C,CAAC,CAChEF,UAAU,CAAC,KAAK,CAAC,CACnB,CAAC,CAAC,CAEJ,KAAM,CAAAW,MAAM,CAAG9B,EAAE,CAACM,MAAM,CAAE,CAAEyB,UAAU,CAAE,CAAC,WAAW,CAAE,CAAC,CAAC,CACxDT,SAAS,CAACU,OAAO,CAAGF,MAAM,CAE1BA,MAAM,CAACG,EAAE,CAAC,SAAS,CAAE,IAAM,CACzBZ,mBAAmB,CAAC,4BAA4B,CAAC,CACnD,CAAC,CAAC,CAEFS,MAAM,CAACG,EAAE,CAAC,YAAY,CAAE,IAAM,CAC5BZ,mBAAmB,CAAC,iCAAiC,CAAC,CACxD,CAAC,CAAC,CAEFS,MAAM,CAACG,EAAE,CAAC,cAAc,CAAEC,KAAA,EAAuB,IAAtB,CAAEC,MAAM,CAAEC,KAAM,CAAC,CAAAF,KAAA,CAC1CpB,SAAS,CAAEuB,IAAI,EAAAC,aAAA,CAAAA,aAAA,IAAWD,IAAI,MAAE,CAACF,MAAM,EAAGC,KAAK,EAAG,CAAC,CACrD,CAAC,CAAC,CAEF,MAAO,IAAM,CACXN,MAAM,CAACS,UAAU,CAAC,CAAC,CACrB,CAAC,CACH,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAC,SAAS,CAAIL,MAAM,EAAK,CAC5B,GAAI,CAACb,SAAS,CAACU,OAAO,CAAE,OACxBV,SAAS,CAACU,OAAO,CAACS,IAAI,CAAC,WAAW,CAAEN,MAAM,CAAC,CAC3CnB,gBAAgB,CAAEqB,IAAI,EAAK,CACzB,KAAM,CAAAK,IAAI,CAAG,GAAI,CAAAzB,GAAG,CAACoB,IAAI,CAAC,CAC1BK,IAAI,CAACC,GAAG,CAACR,MAAM,CAAC,CAChB,MAAO,CAAAO,IAAI,CACb,CAAC,CAAC,CACJ,CAAC,CAED,KAAM,CAAAE,WAAW,CAAIT,MAAM,EAAK,CAC9B,GAAI,CAACb,SAAS,CAACU,OAAO,CAAE,OACxBV,SAAS,CAACU,OAAO,CAACS,IAAI,CAAC,aAAa,CAAEN,MAAM,CAAC,CAC7CnB,gBAAgB,CAAEqB,IAAI,EAAK,CACzB,KAAM,CAAAK,IAAI,CAAG,GAAI,CAAAzB,GAAG,CAACoB,IAAI,CAAC,CAC1BK,IAAI,CAACG,MAAM,CAACV,MAAM,CAAC,CACnB,MAAO,CAAAO,IAAI,CACb,CAAC,CAAC,CACJ,CAAC,CAED,mBACErC,KAAA,QAAKyC,SAAS,CAAC,qBAAqB,CAAAC,QAAA,eAClC1C,KAAA,QAAKyC,SAAS,CAAC,kBAAkB,CAAAC,QAAA,eAC/B1C,KAAA,QAAA0C,QAAA,eACE5C,IAAA,QAAK2C,SAAS,CAAC,YAAY,CAAAC,QAAA,CAAC,cAAY,CAAK,CAAC,cAC9C5C,IAAA,QAAK2C,SAAS,CAAC,YAAY,CAAAC,QAAA,CAAEtC,KAAK,CAAM,CAAC,EACtC,CAAC,cACNN,IAAA,WAAQ2C,SAAS,CAAC,kBAAkB,CAACE,OAAO,CAAEtC,QAAS,CAAAqC,QAAA,CAAC,QAExD,CAAQ,CAAC,EACN,CAAC,cAEN1C,KAAA,QAAKyC,SAAS,CAAC,YAAY,CAAAC,QAAA,eACzB5C,IAAA,SAAM2C,SAAS,CAAC,YAAY,CAAE,CAAC,IAAC,CAAC1B,gBAAgB,EAC9C,CAAC,cAENf,KAAA,YAASyC,SAAS,CAAC,cAAc,CAAAC,QAAA,eAC/B1C,KAAA,QAAKyC,SAAS,CAAC,qBAAqB,CAAAC,QAAA,eAClC5C,IAAA,OAAI2C,SAAS,CAAC,eAAe,CAAAC,QAAA,CAAC,kBAAgB,CAAI,CAAC,cACnD5C,IAAA,MAAG2C,SAAS,CAAC,qBAAqB,CAAAC,QAAA,CAAC,8FAEnC,CAAG,CAAC,EACD,CAAC,CAEL7B,OAAO,cACNf,IAAA,QAAK2C,SAAS,CAAC,WAAW,CAAAC,QAAA,CAAC,iCAA0B,CAAK,CAAC,cAE3D5C,IAAA,QAAK2C,SAAS,CAAC,YAAY,CAAAC,QAAA,CACxBpC,SAAS,CAACsC,GAAG,CAAEd,MAAM,eACpBhC,IAAA,CAACF,QAAQ,EAEPkC,MAAM,CAAEA,MAAO,CACfC,KAAK,CAAEvB,MAAM,CAACsB,MAAM,CAAE,CACtBe,UAAU,CAAEnC,aAAa,CAACoC,GAAG,CAAChB,MAAM,CAAE,CACtCiB,WAAW,CAAEA,CAAA,GAAMZ,SAAS,CAACL,MAAM,CAAE,CACrCkB,aAAa,CAAEA,CAAA,GAAMT,WAAW,CAACT,MAAM,CAAE,EALpCA,MAMN,CACF,CAAC,CACC,CACN,EACM,CAAC,cAEV9B,KAAA,YAASyC,SAAS,CAAC,cAAc,CAAAC,QAAA,eAC/B5C,IAAA,OAAI2C,SAAS,CAAC,eAAe,CAAAC,QAAA,CAAC,oBAAkB,CAAI,CAAC,CACpDhC,aAAa,CAACuC,IAAI,GAAK,CAAC,cACvBnD,IAAA,MAAG2C,SAAS,CAAC,WAAW,CAAAC,QAAA,CAAC,8GAEzB,CAAG,CAAC,cAEJ5C,IAAA,OAAI2C,SAAS,CAAC,mBAAmB,CAAAC,QAAA,CAC9BQ,KAAK,CAACC,IAAI,CAACzC,aAAa,CAAC,CAACkC,GAAG,CAAEQ,CAAC,eAC/BpD,KAAA,OAAYyC,SAAS,CAAC,mBAAmB,CAAAC,QAAA,eACvC5C,IAAA,SAAM2C,SAAS,CAAC,qBAAqB,CAAAC,QAAA,CAAEU,CAAC,CAAO,CAAC,cAChDtD,IAAA,SAAM2C,SAAS,CAAC,oBAAoB,CAAAC,QAAA,CACjClC,MAAM,CAAC4C,CAAC,CAAC,GAAKC,SAAS,CAAG7C,MAAM,CAAC4C,CAAC,CAAC,CAAG,GAAG,CACtC,CAAC,GAJAA,CAKL,CACL,CAAC,CACA,CACL,cAEDtD,IAAA,MAAG2C,SAAS,CAAC,aAAa,CAAAC,QAAA,CAAC,wJAG3B,CAAG,CAAC,EACG,CAAC,EACP,CAAC,CAEV","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}